# Installation

We're using Go 13.4.x and [https://goswagger.io/](https://goswagger.io/) tool to generate API server from swagger.yaml file. To start project:

0. Check github repo
```
git clone https://github.com/tomas-chudjak/freelancertest .
```

1. Generate API server
```
swagger generate server -A api -f ./swagger.yaml
```

2. Get dependencies
```
go get -u -f ./...
```

3. Build main package
```
go build ./cmd/api-server/main.go
```

4. Run package
```
./main --port=3001
```

At this point, the server should be running on the http://localhost:3001
There is one /GET request defined in the swagger, what should be available through the API.

## Tasks

Create dummy API service based on the swagger.yaml specification with following parameters:
- Create active /GET route based on definition in swagger.yaml `Malkhaz: Done`
- Valid /GET request should return HTTP status 200 and data type AuthenticationSubscription in response `Malkhaz: Done for the dummy response, if searching from db, we can use the ProblemDetails structure`
- Invalid /GET request should return HTTP status 400 and data type ProblemDetails `Malkhaz: Done - I've created a custom error_handler to replace swagger default error structure, and now all errors will be as ProblemDetails`

Bonus points:
- ProblemDetails should follow https://tools.ietf.org/html/rfc7807 `Malkhaz: For this particular task, I couldn't find a suitable use case, because there are not enough error, but it's easy to implement for the real project.`
- Identify and use the valid `imsi-` value of {ueId} parameter by it's swagger pattern `Malkhaz: Already done by swagger, but as I checked, the pattern specified in the swagger.yaml file, also accepts all character, to meet the required validation, we should change the pattern to:  ^(imsi-[0-9]{5,15}|nai-.+|msisdn-[0-9]{5,15}|extid-[^@]+@[^@]+)$ or even  ^(imsi-[0-9]{5,15})$ `


### Codebase

- .vscode - contains 2 helper tasks to generate & build project. Tasks are invoked by Ctrl+Shift+B in VSC
- /cmd - autogenerated directory by go-swagger package
- /controllers - all controllers should be located here. Controllers should manipulate responses - send status OK, or throw Error
- /models - autogenerated directory by go-swagger package. Contains all the models
- /restapi - autogenerated directory by go-swagger package. Contains all the operations. Only editable file is *configure_api.go*
- /services - the logic of controller should be placed here
- swagger.yaml - default swagger file


### Tools

Project toolings are:

*Go swagger* - https://goswagger.io/ generate Go server including models and handlers from default swagger.yaml file

### VSC helpers

Found in .vscode/tasks.json

Generate new server from swagger.yaml:
```
swagger generate server -A api -f ./swagger.yaml
```

Build main package:
```
go build ./cmd/api-server/main.go
```


